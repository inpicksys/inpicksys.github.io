Хорошо, я найду асимптотическое выражение для вероятности возврата в ноль через 3n шагов в случайном блуждании, где шаги равны +2 с вероятностью 1/3 и -1 с вероятностью 2/3. Также определю, является ли такое блуждание возвратным или нет. Дайте немного времени — скоро вернусь с результатом.


# Вероятность возврата и асимптотика

Рассматриваемое случайное блуждание задаётся независимыми приращениями ξ<sub>k</sub>, принимающими значения +2 с вероятностью 1/3 и –1 с вероятностью 2/3. Пусть S<sub>n</sub> = ξ<sub>1</sub>+…+ξ<sub>n</sub>. Чтобы вернуться в 0 за n шагов, необходимо, чтобы суммарный сдвиг был нулевым: 2·(число шагов +2) + (–1)·(число шагов –1) = 0. Если обозначить число +2-шагов через r, а число –1-шагов через n–r, то 2r – (n–r) = 0 ⇒ r = n/3. Значит, если n не кратно 3, вероятность возврата P(S<sub>n</sub>=0)=0. Если же n=3k, то r=k и n–r=2k. Тогда вероятность данного сочетания (k шагов +2 и 2k шагов –1) по формуле биномиального распределения равна

$$
P(S_{3k}=0) = \binom{3k}{k}\bigl(\tfrac13\bigr)^k\bigl(\tfrac23\bigr)^{2k}.
$$

Это следует из формулы биномиального распределения: \$P(X=k)=\binom{n}{k}p^k(1-p)^{n-k}\$, где здесь \$n=3k\$, \$k\$ – число успехов (шагов +2), \$p=1/3\$.

## Асимптотический вид \$P(S\_{3n}=0)\$

Для больших \$n\$ используем локальную центральную предельную теорему или приближение по формуле Стирлинга. Поскольку \$S\_{3n}=0\$ равносильно тому, что в биномиальном распределении \$X\sim B(3n,1/3)\$ число успехов \$X=n\$, при \$n\to\infty\$ выполняется асимптотика

$$
\binom{3n}{n}\Bigl(\frac13\Bigr)^n\Bigl(\frac23\Bigr)^{2n}
\;\sim\; \frac{\sqrt{3}}{2\sqrt{\pi}}\,n^{-1/2}.
$$

Подробный вывод основан на использовании формулы Стирлинга для факториалов: в результате коэффициент \$\binom{3n}{n}(1/3)^n(2/3)^{2n}\$ стремится к \$c,n^{-1/2}\$, где \$c=\sqrt{3}/(2\sqrt{\pi})\approx0.4886\$ и показатель степени \$p=-1/2\$. Численно \$c\approx0.489\$ при округлении до трёх знаков. Таким образом

$$
P(S_{3n}=0)\sim c\,n^{-1/2},\quad c=\sqrt{\frac3{4\pi}}\approx0.489,\; p=-0.500.
$$

## Рекуррентность блуждания

По общей теореме о рекуррентности одномерных блужданий, любое случайное блуждание на \$\mathbb Z\$ с нулевым математическим ожиданием шага возвращается в начальную точку с вероятностью 1 (то есть рекуррентно). В частности, поскольку в нашей задаче \$E\[\xi\_k]=2\cdot\tfrac13+(-1)\cdot\tfrac23=0\$, это блуждание **возвратно**. Также о возвратности можно судить по сумме вероятностей возвращения: \$\sum\_{n=1}^\infty P(S\_n=0)\approx\sum\_{k=1}^\infty c k^{-1/2}\$ расходится (так как показатель \$1/2\le1\$), откуда следует возвратность.

**Итого:** \$c\approx0.489\$, \$p=-0.500\$, блуждание **возвратно**.

**Ответ:** *0.489 -0.500 возвратно*.

