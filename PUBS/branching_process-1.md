
# Решение задачи о ветвящемся процессе

**Условие задачи:**

Дано:
- Каждая частица с вероятностью `p` производит **одного** потомка
- С вероятностью `1-p` погибает **без** потомков
- `p ∈ (0,1)`

Требуется найти производящую функцию `Fₙ(z)` для общего числа частиц в первых `n` поколениях.

## 1. Производящая функция потомков одной частицы
Для одной частицы производящая функция имеет вид:
```math
G(z) = p z + (1 - p)
```

## 2. Рекуррентное соотношение
Общее число частиц в первых `n` поколениях выражается через:
```math
Fₙ(z) = z \cdot G(F_{n-1}(z))
```
где:
- `z` - исходная частица
- `G(F_{n-1}(z))` - вклад всех её потомков

## 3. Подстановка конкретной G(z)
```math
Fₙ(z) = z \left[ p F_{n-1}(z) + (1 - p) \right]
```

## 4. Решение рекуррентного соотношения
Для малых `n`:
- `F₁(z) = z`
- `F₂(z) = z(pz + (1-p))`
- `F₃(z) = p²z³ + p(1-p)z² + (1-p)z`

Общее решение:
```math
Fₙ(z) = \sum_{k=1}^n (1-p)p^{k-1}z^k + p^n z^{n+1}
```

## 5. Замкнутая форма
```math
Fₙ(z) = \frac{(1-p)z(1-(pz)^n)}{1-pz} + p^n z^{n+1}
```

## Проверка
Для `n=1`:
```math
F₁(z) = \frac{(1-p)z(1-pz)}{1-pz} + p z² = (1-p)z + p z² = z
```
что соответствует ожидаемому результату.

**Итоговый ответ:**
```math
Fₙ(z) = \boxed{\frac{(1-p)z(1-(pz)^n)}{1-pz} + p^n z^{n+1}}
```